!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("gettext",e):(t=t||self).gettext=e()}(this,function(){"use strict";return function(t){t=t||{},this.__version="0.5.3";var e={domain:"messages",locale:"undefined"!=typeof document&&document.documentElement.getAttribute("lang")||"en",plural_func:function(t){return{nplurals:2,plural:1!=t?1:0}},ctxt_delimiter:String.fromCharCode(4)},n=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},r={},l=t.locale||e.locale,a=t.domain||e.domain,o={},u={},i=t.ctxt_delimiter||e.ctxt_delimiter;t.messages&&(o[a]={},o[a][l]=t.messages),t.plural_forms&&(u[l]=t.plural_forms);var s=function(t){var e=arguments;return t.replace(/%%/g,"%% ").replace(/%(\d+)/g,function(t,n){return e[n]}).replace(/%% /g,"%")},p=function(t){for(var e=[t],n=t.lastIndexOf("-");n>0;)t=t.slice(0,n),e.push(t),n=t.lastIndexOf("-");return e},c=function(t,e,n){return 1===t.length?s.apply(this,[t[0]].concat(Array.prototype.slice.call(arguments,3))):(n.plural_func?a=n.plural_func(e):r[l]?a=r[l](e):(r[l]=function(t){if(!new RegExp("^\\s*nplurals\\s*=\\s*[0-9]+\\s*;\\s*plural\\s*=\\s*(?:\\s|[-\\?\\|&=!<>+*/%:;n0-9_()])+").test(t))throw new Error(s('The plural form "%1" is not valid',t));return new Function("n","var plural, nplurals; "+t+" return { nplurals: nplurals, plural: (plural === true ? 1 : (plural ? plural : 0)) };")}(u[l]),a=r[l](e)),(void 0===a.plural||a.plural>a.nplurals||t.length<=a.plural)&&(a.plural=0),s.apply(this,[t[a.plural],e].concat(Array.prototype.slice.call(arguments,3))));var a};return{strfmt:s,expand_locale:p,__:function(){return this.gettext.apply(this,arguments)},_n:function(){return this.ngettext.apply(this,arguments)},_p:function(){return this.pgettext.apply(this,arguments)},setMessages:function(t,e,r,l){if(!t||!e||!r)throw new Error("You must provide a domain, a locale and messages");if("string"!=typeof t||"string"!=typeof e||!n(r))throw new Error("Invalid arguments");return l&&(u[e]=l),o[t]||(o[t]={}),o[t][e]=r,this},loadJSON:function(t,r){if(n(t)||(t=JSON.parse(t)),!t[""]||!t[""].language||!t[""]["plural-forms"])throw new Error('Wrong JSON, it must have an empty key ("") with "language" and "plural-forms" information');var l=t[""];return delete t[""],this.setMessages(r||e.domain,l.language,t,l["plural-forms"])},setLocale:function(t){return l=t,this},getLocale:function(){return l},textdomain:function(t){return t?(a=t,this):a},gettext:function(t){return this.dcnpgettext.apply(this,[undef,undef,t,undef,undef].concat(Array.prototype.slice.call(arguments,1)))},ngettext:function(t,e,n){return this.dcnpgettext.apply(this,[undef,undef,t,e,n].concat(Array.prototype.slice.call(arguments,3)))},pgettext:function(t,e){return this.dcnpgettext.apply(this,[undef,t,e,undef,undef].concat(Array.prototype.slice.call(arguments,2)))},dcnpgettext:function(t,n,r,u,s){if(t=t||a,"string"!=typeof r)throw new Error(this.strfmt('Msgid "%1" is not a valid translatable string',r));var f,d,g,y={},h=n?n+i+r:r,m=p(l);for(var x in m)if(g=m[x],d=o[t]&&o[t][g]&&o[t][g][h],d=u?d&&"string"!=typeof o[t][g][h]:d&&"string"==typeof o[t][g][h])break;return d?f=o[t][g][h]:(f=r,y.plural_func=e.plural_func),c.apply(this,u?[d?f:[r,u],s,y].concat(Array.prototype.slice.call(arguments,5)):[[f],s,y].concat(Array.prototype.slice.call(arguments,5)))}}}});